@startuml
title Activity Diagram - Flow Pendaftaran Awal PPDB SMK (Revisi Tanpa Dashboard Calon Siswa)

start

:Calon siswa membuka website PPDB;
note right
Akses awal sistem.
Belum ada asumsi login.
end note

if (Sudah memiliki akun?) then (Tidak)
  :Daftar akun baru;
  note right
  Pembuatan akun:
  - email / username
  - password
  Tidak termasuk data pendaftaran.
  end note
endif

:Login calon siswa;
note right
Setelah login, sistem
SELALU mengarahkan ke
state terakhir pendaftaran.
end note

if (Data pendaftaran sudah ada?) then (Tidak)
  :Buat data pendaftaran;
  note right
  Insert awal:
  - status = draft
  - current_step = 0
  end note
else (Ya)
  if (Status pendaftaran = submitted?) then (Ya)
    :Tampilkan Halaman Ringkasan Informasi Calon Siswa;
    note right
    Menampilkan seluruh data
    pendaftaran secara read-only.
    Form tidak dapat diakses lagi.
    end note
    stop
  endif
endif

:Ambil nilai current_step;
note right
Digunakan untuk menentukan
step mana yang harus ditampilkan.
end note

:Redirect ke step (current_step + 1);

partition "Multi-Step Pendaftaran (Draft Mode)" {

  :Isi Step 1 - Biodata Calon Siswa;
  note right
  Data identitas utama.
  Disimpan saat klik 'Berikutnya'.
  end note

  :Validasi Step 1;
  :Simpan / Update data;
  :Set current_step = 1;

  :Isi Step 2 - Data Orang Tua / Wali;
  note right
  Pola sama dengan Step 1.
  end note

  :Validasi Step 2;
  :Simpan / Update data;
  :Set current_step = 2;

  :Upload berkas (per berkas);
  note right
  Setiap berkas:
  - upload langsung
  - simpan langsung
  - status per berkas
  end note

  :Cek semua berkas wajib lengkap;
  :Set current_step = 3;

  :Isi Step 4 - Konfirmasi & Pernyataan;
  note right
  Menampilkan ringkasan data.
  User menyatakan data benar.
  end note
}

if (Setuju & Kirim pendaftaran?) then (Ya)
  :Validasi seluruh step;
  :Set current_step = 4;

  :Ubah status = submitted;
  note right
  Titik final pendaftaran.
  Data dikunci (read-only).
  end note

  :Tampilkan notifikasi sukses;
  :Redirect ke Halaman Ringkasan Informasi Calon Siswa;
else (Tidak)
  :Tetap di halaman konfirmasi;
endif

stop
@enduml
