@startuml
skinparam SwimlaneTitleFontSize 14
skinparam SwimlaneBorderThickness 1
skinparam ActivityBackgroundColor #FEFECE
skinparam ActivityBorderColor #A80036
skinparam ActivityFontSize 12
skinparam ArrowColor #A80036
skinparam Shadowing false

actor "Kepala Sekolah / Operator Sekolah" as Admin
boundary "Halaman Laporan" as View
control "LaporanController" as Ctrl
entity "Pendaftaran" as Model
entity "ExcelGenerator" as Excel

Admin -> View : Mengakses menu laporan
activate View
View -> Ctrl : index()
activate Ctrl
Ctrl -> Model : getSummaryData()
activate Model
Model --> Ctrl : summaryData
deactivate Model
Ctrl -> View : renderDashboard(summaryData)
deactivate Ctrl

alt Filter Data
    Admin -> View : Pilih filter and Terapkan
    View -> Ctrl : filter(request)
    activate Ctrl
    Ctrl -> Model : getFilteredData(request)
    Model --> Ctrl : resultData
    Ctrl --> View : renderTable(resultData)
    deactivate Ctrl
end

alt Export Laporan
    Admin -> View : Klik Export Excel
    View -> Ctrl : export(request)
    activate Ctrl
    
    Ctrl -> Model : getFilteredData(request)
    Model --> Ctrl : data
    
    Ctrl -> Excel : generate(data)
    activate Excel
    Excel --> Ctrl : fileStream
    deactivate Excel
    
    Ctrl --> View : Download File
    View --> Admin : Receive File
    deactivate Ctrl
end

deactivate View

@enduml
